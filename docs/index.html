<!DOCTYPE html>
<html>
    <head>
        <title>Memphis Database</title>


<style>
.dropbtn {
  background-color: #3498DB;
  color: white;
  padding: 16px;
  font-size: 16px;
  border: none;
  cursor: pointer;
}

.dropbtn:hover, .dropbtn:focus {
  background-color: #2980B9;
}

.dropdown {
  position: relative;
  display: inline-block;
}

.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f1f1f1;
  min-width: 160px;
  overflow: auto;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
}

.dropdown a:hover {background-color: #ddd;}
.select-wrapper {
     background-color: #3498DB;
      font-size: 26px;
      width: 200px;
    }
.show {display: block;}

.w2ui-field input {
    width: 200px;
}
.w2ui-field > div > span {
    margin-left: 20px;
}
</style>
  <link rel="stylesheet" type="text/css" href="css/w2ui.css" />
  <script src="js/jquery.js"></script>
  <script type="text/javascript" src="js/w2ui.js"></script>

</head>
    <body>
<span></span>

 
<select name="dropdown" size=4>

    <option value="dating.json">dating</option>
    <option value="persons.json">persons</option>
    <option value="objects.json">objects</option>
    <option value="titles.json">titles</option>
    <option value="relation.json">relation</option>
</select>

<!--<div class="w2ui-field w2ui-span3"> <label>SQL Table</label><div> <input type="list"> <span class="legend"></span> </div></div>-->
<div id="layout" style="width: 100%; height: 900px;"></div>


<script>
$(function () {
   var pstyle = 'border: 1px solid #dfdfdf; padding: 5px;';
    $('#layout').w2layout({
        name: 'layout',
        panels: [
           
            { type: 'main', size: 500, style: pstyle, content: '<div id="sql" style="height: 700px"></div>' },
            { type: 'bottom', size: 500, style: pstyle, content: '<iframe id="metadata" src="" height="100%" width="100%"></iframe>' }
        ]
    });
});
var dataset=""
$('select[name="dropdown"]').change(function() {
    dataset=$(this).val()

var data_from_ajax;
$("document").ready(function(){
  $.getJSON(dataset, function(obj) {
  
  if (w2ui['sql'] != null) {
  w2ui['sql'].destroy();
  
  };  
  $('#sql').w2grid({ 
    name   : 'sql', 
    show: { 
            lineNumbers: true,
            toolbar: true,
            footer: true
    },
    multiSearch: true,
    searches: obj[0],
    columns: obj[1],
    records: obj[2],
  
     onClick: function(event) {
     var grid = this;
      event.onComplete = function() {
        var sel_rec_ids = grid.getSelection();
        if (sel_rec_ids.length) {
          var sel_record = grid.get(sel_rec_ids[0]);
          if (dataset === 'persons.json') {id=(parseInt(sel_record.id_persons)+10000).toString()}
          //if (dataset === 'persons.json') {id=sel_record.id_persons}
          if (dataset === 'objects.json') {id=sel_record.id_objects}
          loadMetadata(id);
          
        } else {
          alert("Nothing selected!");
        }
    
    }
    }  
       });   
    
    });
}); //from drop-down

function loadMetadata(obj)
{
    
      document.getElementById('metadata').setAttribute('src', "https://repositorytest.ancient-astronomy.org/collection/PROM/object/"+obj);
};

//obj.preventDefault();
});


</script>
<div></div>
</body>
</html>

